{% extends "base.html" %}
{% block content %}

<h2 class="mb-4">Pilih Kursi</h2>

<style>
  .seat-grid {
    display: grid;
    grid-template-columns: repeat(10, 45px);
    gap: 10px;
    margin-bottom: 20px;
  }
  .seat {
    width: 45px;
    height: 45px;
    background: #444;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 6px;
    cursor: pointer;
  }
  .seat.selected {
    background: #28a745;
  }
  .seat.booked {
    background: #b30000;
    cursor: not-allowed;
  }
</style>

<div>
  {% for row in ["A","B","C","D","E","F"] %}
    <div class="seat-grid">
      {% for num in range(1,11) %}
        {% set seat = row ~ num %}
        <div class="seat 
            {% if seat in booked %} booked {% endif %}"
          data-seat="{{ seat }}">
          {{ seat }}
        </div>
      {% endfor %}
    </div>
  {% endfor %}
</div>

<form method="POST" action="/checkout" id="formKursi">
  <input type="hidden" name="schedule_id" value="{{ schedule_id }}">
  <input type="hidden" name="seats" id="seatInput">
  <button type="submit" class="btn btn-primary d-none" id="btnCheckout">
    Lanjutkan Checkout
  </button>
</form>

<script>
  const selectedSeats = [];
  const seatInput = document.getElementById("seatInput");
  const btnCheckout = document.getElementById("btnCheckout");

  document.querySelectorAll(".seat").forEach(seat => {
    seat.addEventListener("click", () => {
      if (seat.classList.contains("booked")) return;

      const seatId = seat.dataset.seat;

      if (seat.classList.contains("selected")) {
        seat.classList.remove("selected");
        selectedSeats.splice(selectedSeats.indexOf(seatId), 1);
      } else {
        seat.classList.add("selected");
        selectedSeats.push(seatId);
      }

      seatInput.value = selectedSeats.join(",");
      btnCheckout.classList.toggle("d-none", selectedSeats.length === 0);
    });
  });
</script>

{% endblock %}
